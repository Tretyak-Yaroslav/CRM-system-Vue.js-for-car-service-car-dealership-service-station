<Disposition>
    <div style="margin:0px 10px;">
      <FullCalendar
        ref="fullcalendar"
        :plugins="calendarPlugins"
        defaultView="resourceTimelineDay"
        resourceLabelText=" "
        nowIndicator="true"
        timeZone="en-GB"
        :header="{      
                        left: 'prev,next, today',
                        center: 'title',
                        right: 'resourceTimelineDay,resourceTimelineWeek'
                      }"
        displayEventTime="true"
        displayEventEnd="true"
        selectable="true"
        :eventTimeFormat="{
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        meridiem: false
                      }"
        :resources="workplaces"
        :events="events"
        :allDay="true"
        :eventClick="true"
        :eventRender="eventRender"
        minTime="09:00:00"
        maxTime="21:00:00"
        @eventClick="eventClick"
        @select="handleSelect"
      />
      <b-popover ref="refpopover" :target="tooltip.target" :key="tooltip.key" triggers="hover" placement="bottom" >
            <div v-html="tooltip.content"> </div>
      </b-popover> 
      <div id="forempty"> </div>

      <ul class="list-inline" style="margin-top:10px">
        <li  class="list-inline-item" v-bind:style="{background: item.color, padding: 5 +'px'}" v-for="item in masters" v-bind:key="item.id">{{item.text}} </li>
      </ul>

      <!--Modal Create Query-->
      <b-modal id="modal-create" :title="modal.title">
        <div class="row">
          <div class="col-6 if-available left">
            <div class="form-group">
              <b-form-input
                placeholder="Введіть ім'я"
                required
                id="customerID"
                v-model="form.customerFullName"
              ></b-form-input>
            </div>
          </div>
          <div class="col-6 if-available right">
            <div class="form-group">
              <masked-input
                placeholder="Телефон"
                v-model="form.customerPhoneNumber"
                type="text"
                name="phone"
                class="form-control"
                mask="\+\38 (111) 111-1111"
                required
              />
            </div>
          </div>
          <div class="col-6 if-available left">
            <label class="control-label">Дата:</label>
              <b-form-input 
              :value="cStartDateTime"
              @input="stringToDateTime"
              class="form-control"
              type="date"
              required> 
          </b-form-input>
          </div>
          <div class="col-6 if-available left">
            <label class="control-label">Початок роботи</label>
            <b-form-input
             class="mr-b"
             :value="cStartTime"
             @input="stringToStartTime"
             type="time">
          </b-form-input>
          </div>
          <div class="col-6 if-available right">
            <label class="control-label">Закінчення роботи</label>
            <b-form-input 
            class="mr-b"  
            :value="cEndTime"
            @input="stringToEndTime"
            type="time"></b-form-input>
          </div>
          <div class="col-6 if-available right">
          <b-alert
          :show="showDismissibleAlert"
          variant="danger">
          <p>{{ eventModalAlert }}</p>
        </b-alert>
          </div>

        </div>
        <b-form-group id="vendorName" label="Марка:" label-for="vendorName">
          <b-form-select
            v-model="form.vendorID"
            :options="vendors"
            value-field="id"
            text-field="text"
            v-on:change="getSelectedBrand"
            required
          ></b-form-select>
        </b-form-group>
        <b-form-group label="Модель:" label-for="vehicleModelName">
          <b-form-select
            v-model="form.vehicleModelID"
            :options="vehicleModels"
            value-field="id"
            text-field="text"
            required
          ></b-form-select>
        </b-form-group>
        <b-form-group id="vehicleRegistrationNumber" label-for="vehicleRegistrationNumber">
          <b-form-input
            id="vehicleRegistrationNumber"
            v-model="form.vehicleRegistrationNumber"
            required
            placeholder="Введіть номер автомобіля"
          ></b-form-input>
        </b-form-group>
        <div class="form-group">
          <label class="control-label">Пост:</label>
          <b-form-select
            id="workplace"
            v-model="form.workplaceID"
            :options="workplaces"
            value-field="id"
            text-field="title"
            required
          ></b-form-select>
        </div>
        <b-form-group id="itemCategory" label="Послуга:" label-for="itemCategory">
          <b-form-select
            id="itemCategory"
            v-model="form.itemID"
            :options="itemCategories"
            value-field="id"
            text-field="text"
            required
          ></b-form-select>
        </b-form-group>
        <div class="form-group">
          <label class="control-label">Мастер-приймальник</label>
          <b-form-select  v-model="form.masterID"
           :options="masters" 
           value-field="id"
           text-field="text" 
           required></b-form-select>
        </div>
        <div class="form-group">
          <label class="control-label">Механік</label>
          <b-form-select
           v-model="form.mechanicID" 
           :options="mechanics" 
           value-field="id"
           text-field="text" 
           required></b-form-select>
        </div>
        <b-form-textarea
          v-model="form.queryDescription"
          placeholder="Коментар"
          rows="2"
          max-rows="2"
        ></b-form-textarea>
        <b-row class="mt-1">
          <b-col sm="7" md="7" offset-md="0" class="d-flex justify-content-end p-0">
            <b-button @click="$bvModal.hide('modal-create')">ЗАКРИТИ</b-button>
          </b-col>
          <b-col class="d-flex justify-content-end">
            <b-button class="ml-auto pr-5 pl-5" variant="primary " @click="saveQuery(true)">ЗБЕРЕГТИ</b-button>
          </b-col>
        </b-row>
        <br>

      </b-modal>
      <!-- End modal-->
      <b-modal id="modal-delete" title='Видалити заявку?' >
          <b-button class="mt-3" variant="outline-danger" block @click="saveQuery(false,true),$bvModal.hide('modal-delete')">Так</b-button>
      </b-modal>
      <!-- Modal Edit -->
      <b-modal id="modal-edit" >
          <template v-slot:modal-header="{ close }">
              <h4>{{modal.title}}</h4>
              <button type="button" class="close text-right" @click="$bvModal.show('modal-delete');" >
                <span aria-hidden="true">&#128686;</span>
              </button> 

              <button type="button"  class="close" aria-label="Close" @click="$bvModal.hide('modal-edit')">
                  <span aria-hidden="true">&times;</span>
              </button>
            </template>

          <div class="row">
            <div class="col-6 if-available left">
              <div class="form-group">
                <label class="control-label">Статус</label>
                <b-form-select
                  id="master"
                  v-model="form.queryStatusID"
                  :options="queryStatuses"
                  value-field="id"
                  text-field="text"
                  required
                ></b-form-select>
              </div>
            </div>
            <div class="col-6 if-available right">
              <div class="form-group">
                <label class="control-label">Пост</label>
                <b-form-select
                  id="workplace"
                  v-model="form.workplaceID"
                  :options="workplaces"
                  value-field="id"
                  text-field="title"
                  required
                ></b-form-select>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label">Мастер</label>
            <b-form-select 
            v-model="form.masterID" 
            :options="masters"
            value-field="id"
            text-field="text"
             required></b-form-select>
          </div>
          <div class="form-group">
            <label class="control-label">Механік</label>
            <b-form-select
             v-model="form.mechanicID" 
             :options="mechanics"
             value-field="id"
             text-field="text"
             required></b-form-select>
          </div>
          <b-form-group
            id="vehicleRegistrationNumber"
            label="Номер автомобіля:"
            label-for="vehicleRegistrationNumber"
          >
            <b-form-input
              id="vehicleRegistrationNumber"
              v-model="form.vehicleRegistrationNumber"
              required
              placeholder="Введіть номер автомобіля"
            ></b-form-input>
          </b-form-group>
          <div class="form-group">
            <label class="control-label">Послуга</label>
            <b-form-select
              v-model="form.itemID"
              :options="itemCategories"
              value-field="id"
              text-field="text"
              required
            ></b-form-select>
          </div>
          <div class="row">
            <div class="col-6 if-available left">
              <div class="form-group">
                <label class="control-label">Ім'я:</label>
                <b-form-input
                  placeholder="Введіть ім'я"
                  required
                  v-model="form.customerFullName"
                ></b-form-input>
              </div>
            </div>
            <div class="col-6 if-available right">
              <div class="form-group">
                <label class="control-label">Телефон</label>
                <masked-input
                  v-model="form.customerPhoneNumber"
                  required
                  type="text"
                  name="phone"
                  class="form-control"
                  mask="\+\38 (111) 111-1111"
                />
              </div>
            </div>
            <div class="col-6 if-available left">
              <label class="control-label">Початок роботи</label>
              <b-form-input
              class="mr-b" 
              :value="cStartTime"
              @input="stringToStartTime"
              min="09:00" max="20:00"
              type="time"></b-form-input>
            </div>
            <div class="col-6 if-available right">
              <label class="control-label">Закінчення роботи</label>
              <b-form-input 
              class="mr-b" 
              :value="cEndTime"
              @input="stringToEndTime"
              min="09:00" max="20:00"
              type="time"></b-form-input>
            </div>
          </div>
          <b-form-textarea
            id="queryDescription"
            v-model="form.queryDescription"
            placeholder="Коментар"
          ></b-form-textarea>
          <b-button class="mt-3" variant="outline-success" block @click="saveQuery(false)">Зберегти зміни</b-button>
          <br>
          <b-alert
          :show="showDismissibleAlert"
          variant="danger">
          <p>{{ eventModalAlert }}</p>
        </b-alert>
    
        </b-modal>

      <DetailsTable></DetailsTable>
    </div>
  </Disposition>